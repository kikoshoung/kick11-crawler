INSERT INTO `competitionteam`(`competition_id`,`team_id`) SELECT transfermarket_competition.competition_ref_id,transfermarket_team.team_ref_id FROM `transfermarket_competition` JOIN `transfermarket_competition_team` ON transfermarket_competition.competition_id = transfermarket_competition_team.competition_id JOIN `transfermarket_team` ON transfermarket_team.id = transfermarket_competition_team.team_id WHERE CONCAT(transfermarket_competition.competition_ref_id, '-', transfermarket_team.team_ref_id) NOT IN (SELECT CONCAT(competition_id, '-', team_id) FROM `competitionteam`) AND transfermarket_team.team_ref_id != 0

INSERT INTO `events_teams`(`event_id`,`team_id`) SELECT events.id,transfermarket_team.team_ref_id FROM `events` JOIN `competition` ON events.competition_id = competition.id JOIN `transfermarket_competition` ON transfermarket_competition.competition_ref_id = competition.id JOIN `transfermarket_competition_team` ON transfermarket_competition.competition_id = transfermarket_competition_team.competition_id JOIN `transfermarket_team` ON transfermarket_team.id = transfermarket_competition_team.team_id WHERE CONCAT(events.id, '-', transfermarket_team.team_ref_id) NOT IN (SELECT CONCAT(event_id, '-', team_id) FROM `events_teams`) AND transfermarket_team.team_ref_id != 0